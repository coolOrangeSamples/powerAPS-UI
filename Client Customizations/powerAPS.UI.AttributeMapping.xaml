<wpf:ThemedWPFWindow xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:wpf="clr-namespace:Autodesk.DataManagement.Client.Framework.Forms.Controls.WPF;assembly=Autodesk.DataManagement.Client.Framework.Forms"
    Title="Attribute Mappings"
    Height="550" MinHeight="550" Width="500" MinWidth="500" FontFamily="Segoe UI" FontSize="12.5"
    Icon="pack://application:,,,/powerAPS.Utils;component/Resources/coolorange.ico"
    WindowStartupLocation="CenterOwner">

    <wpf:ThemedWPFWindow.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/Autodesk.DataManagement.Client.Framework.Forms;component/Controls/WPF/ControlTemplates/MergedResources.xaml" />
                <ResourceDictionary Source="pack://application:,,,/powerAPS.Utils;component/Controls/WPF/ImageResources.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <Style TargetType="{x:Type DataGrid}" BasedOn="{StaticResource ThemedDataGridStyle}"/>
            <Style TargetType="{x:Type DataGridColumnHeader}" BasedOn="{StaticResource ThemedDataGridColumnHeaderStyle}"/>
            <Style TargetType="{x:Type Thumb}" BasedOn="{StaticResource ColumnHeaderGripperStyle}"/>
            <Style TargetType="{x:Type DataGridRow}" BasedOn="{StaticResource ThemedDataGridRowStyle}">
                <Setter Property="Padding" Value="0" />
            </Style>
            <Style TargetType="{x:Type DataGridCell}" BasedOn="{StaticResource ThemedDataGridCellStyle}"/>
            <Style TargetType="{x:Type ComboBox}" BasedOn="{StaticResource ThemedComboBoxStyle}">
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Margin" Value="0" />
                <Setter Property="Height" Value="28" />
            </Style>
            <Style TargetType="{x:Type Button}" BasedOn="{StaticResource ThemedButtonStyle}">
                <Setter Property="FontSize" Value="12" />
                <Setter Property="Height" Value="29" />
            </Style>
            <Style TargetType="{x:Type Label}" BasedOn="{StaticResource ThemedLabelStyle}">
                <Setter Property="FontSize" Value="12" />
            </Style>
        </ResourceDictionary>
    </wpf:ThemedWPFWindow.Resources>

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="36" />
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,8">
            <Button x:Name="AddRow" MinWidth="90" Margin="0,0,8,0" Content="New"/>
            <Button x:Name="RemoveRow" MinWidth="90" Content="Delete"/>
        </StackPanel>
        
        <DataGrid x:Name="MappingGrid" Grid.Row="1" 
                  AutoGenerateColumns="False" 
                  HeadersVisibility="Column" 
                  CanUserAddRows="False" 
                  CanUserDeleteRows="False" 
                  RowHeaderWidth="0" 
                  SelectionMode="Extended" SelectionUnit="FullRow"
            ItemsSource="{Binding Mapping}" GridLinesVisibility="Horizontal" >

            <DataGrid.Columns>
                <DataGridComboBoxColumn 
                    Header="Vault File Property"
                    SelectedItemBinding="{ Binding Path=Vault, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                    Width="*">
                    <DataGridComboBoxColumn.ElementStyle>
                        <Style TargetType="{x:Type ComboBox}" BasedOn="{StaticResource ThemedComboBoxStyle}">
                            <Setter Property="ItemsSource" Value="{Binding Path=DataContext.VaultProperties, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" />
                            <Setter Property="Margin" Value="2,2,2,2" />
                        </Style>
                    </DataGridComboBoxColumn.ElementStyle>
                    <DataGridComboBoxColumn.EditingElementStyle>
                        <Style TargetType="{x:Type ComboBox}" BasedOn="{StaticResource ThemedComboBoxStyle}">
                            <Setter Property="ItemsSource" Value="{Binding Path=DataContext.VaultProperties, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" />
                        </Style>
                    </DataGridComboBoxColumn.EditingElementStyle>
                </DataGridComboBoxColumn>
                
                <DataGridTemplateColumn Width="15" IsReadOnly="True">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="-&gt;" Width="16" Height="16" HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                
                <DataGridComboBoxColumn 
                    Header="ACC Custom Attribute"
                    SelectedItemBinding="{ Binding Path=Acc, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }"
                    Width="*">
                    <DataGridComboBoxColumn.ElementStyle>
                        <Style TargetType="{x:Type ComboBox}" BasedOn="{StaticResource ThemedComboBoxStyle}">
                            <Setter Property="ItemsSource" Value="{Binding Path=DataContext.AccAttributes, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" />
                            <Setter Property="Margin" Value="2,2,2,2" />
                        </Style>
                    </DataGridComboBoxColumn.ElementStyle>
                    <DataGridComboBoxColumn.EditingElementStyle>
                        <Style TargetType="{x:Type ComboBox}" BasedOn="{StaticResource ThemedComboBoxStyle}">
                            <Setter Property="ItemsSource" Value="{Binding Path=DataContext.AccAttributes, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" />
                        </Style>
                    </DataGridComboBoxColumn.EditingElementStyle>
                </DataGridComboBoxColumn>
            </DataGrid.Columns>
        </DataGrid>

        <Grid Grid.Row="2" VerticalAlignment="Bottom">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="110" />
                <ColumnDefinition Width="100"/>
            </Grid.ColumnDefinitions>
            <Button x:Name="Ok" Grid.Column="1" Width="100" Margin="0,0,10,0">OK</Button>
            <Button x:Name="Cancel" Grid.Column="2" Width="100" IsCancel="True">Cancel</Button>
        </Grid>
    </Grid>
</wpf:ThemedWPFWindow>